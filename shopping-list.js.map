{"version":3,"file":"shopping-list.js","sources":["../src/js/shoppingList.js"],"sourcesContent":["import { getGameByID } from './infoFromDB.js';\n\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\n    console.log(\"shoppingList.js is active\");\n    const activeUser = JSON.parse(localStorage.getItem(\"activeUser\")); // Отримуємо активного користувача\n    const blurOverlay = document.getElementById(\"blur-overlay\");\n    const redirectLoginButton = document.getElementById(\"redirect-login\");\n\n    // Якщо користувач не залогінений\n    if (!activeUser) {\n        blurOverlay.classList.remove(\"hidden\");\n        redirectLoginButton.addEventListener(\"click\", () => {\n            window.location.href = \"./auth.html\"; // Перенаправляємо на сторінку авторизації\n        });\n        return; // Зупиняємо виконання коду\n    }\n\n    // Якщо користувач залогінений\n    blurOverlay.classList.add(\"hidden\");\n\n    const cartKey = `cart_${activeUser.username}`;\n    const cart = JSON.parse(localStorage.getItem(cartKey)) || []; // Отримуємо кошик користувача\n\n    const shoppingListContainer = document.getElementById(\"shopping-list-container\");\n    const emptyCartMessage = document.querySelector(\".empty-cart\");\n\n    if (cart.length === 0) {\n        // Якщо кошик порожній\n        emptyCartMessage.classList.remove(\"hidden\");\n    } else {\n        emptyCartMessage.classList.add(\"hidden\");\n\n        // Завантажуємо дані про ігри\n        const gameDetails = await Promise.all(cart.map(id => getGameByID(id)));\n        renderShoppingList(gameDetails, shoppingListContainer, cartKey);\n    }\n});\n\nfunction renderShoppingList(games, container, cartKey) {\n    container.innerHTML = \"\"; // Очищаємо контейнер\n\n    games.forEach((game) => {\n        const item = document.createElement(\"div\");\n        item.classList.add(\"shopping-list-item\");\n\n        item.innerHTML = `\n            <div class=\"game-image-container\">\n                <img src=\"${game.image}\" alt=\"${game.title}\" class=\"shopping-list-image\">\n            </div>\n            <div class=\"shopping-list-details\">\n                <h3 class=\"shopping-list-title\">${game.title}</h3>\n                <p class=\"shopping-list-author\">by ${game.author}</p>\n                <p class=\"shopping-list-description\">${game.description || \"No description available\"}</p>\n            </div>\n            <button class=\"remove-game-btn\" data-id=\"${game.id}\">&times;</button>\n        `;\n\n        container.appendChild(item);\n    });\n\n    // Обробники для кнопок видалення\n    container.querySelectorAll(\".remove-game-btn\").forEach(button => {\n        button.addEventListener(\"click\", (event) => {\n            const gameId = button.dataset.id;\n            removeGameFromCart(gameId, cartKey, container);\n        });\n    });\n}\n\nfunction removeGameFromCart(gameId, cartKey, container) {\n    const cart = JSON.parse(localStorage.getItem(cartKey)) || []; // Отримуємо кошик\n    const updatedCart = cart.filter(id => id !== gameId); // Видаляємо вибрану гру\n\n    localStorage.setItem(cartKey, JSON.stringify(updatedCart)); // Оновлюємо localStorage\n\n    const gameElement = container.querySelector(`.remove-game-btn[data-id=\"${gameId}\"]`).closest(\".shopping-list-item\");\n    if (gameElement) {\n        gameElement.remove(); // Видаляємо гру з DOM\n    }\n\n    // Якщо кошик спорожнів\n    if (updatedCart.length === 0) {\n        document.querySelector(\".empty-cart\").classList.remove(\"hidden\");\n    }\n}\n"],"names":["activeUser","blurOverlay","redirectLoginButton","cartKey","cart","shoppingListContainer","emptyCartMessage","gameDetails","id","getGameByID","renderShoppingList","games","container","game","item","button","event","gameId","removeGameFromCart","updatedCart","gameElement"],"mappings":"kFAEA,SAAS,iBAAiB,mBAAoB,SAAY,CACtD,QAAQ,IAAI,2BAA2B,EACvC,MAAMA,EAAa,KAAK,MAAM,aAAa,QAAQ,YAAY,CAAC,EAC1DC,EAAc,SAAS,eAAe,cAAc,EACpDC,EAAsB,SAAS,eAAe,gBAAgB,EAGpE,GAAI,CAACF,EAAY,CACbC,EAAY,UAAU,OAAO,QAAQ,EACrCC,EAAoB,iBAAiB,QAAS,IAAM,CAChD,OAAO,SAAS,KAAO,aACnC,CAAS,EACD,MACH,CAGDD,EAAY,UAAU,IAAI,QAAQ,EAElC,MAAME,EAAU,QAAQH,EAAW,QAAQ,GACrCI,EAAO,KAAK,MAAM,aAAa,QAAQD,CAAO,CAAC,GAAK,GAEpDE,EAAwB,SAAS,eAAe,yBAAyB,EACzEC,EAAmB,SAAS,cAAc,aAAa,EAE7D,GAAIF,EAAK,SAAW,EAEhBE,EAAiB,UAAU,OAAO,QAAQ,MACvC,CACHA,EAAiB,UAAU,IAAI,QAAQ,EAGvC,MAAMC,EAAc,MAAM,QAAQ,IAAIH,EAAK,IAAII,GAAMC,EAAYD,CAAE,CAAC,CAAC,EACrEE,EAAmBH,EAAaF,EAAuBF,CAAO,CACjE,CACL,CAAC,EAED,SAASO,EAAmBC,EAAOC,EAAWT,EAAS,CACnDS,EAAU,UAAY,GAEtBD,EAAM,QAASE,GAAS,CACpB,MAAMC,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAU,IAAI,oBAAoB,EAEvCA,EAAK,UAAY;AAAA;AAAA,4BAEGD,EAAK,KAAK,UAAUA,EAAK,KAAK;AAAA;AAAA;AAAA,kDAGRA,EAAK,KAAK;AAAA,qDACPA,EAAK,MAAM;AAAA,uDACTA,EAAK,aAAe,0BAA0B;AAAA;AAAA,uDAE9CA,EAAK,EAAE;AAAA,UAGtDD,EAAU,YAAYE,CAAI,CAClC,CAAK,EAGDF,EAAU,iBAAiB,kBAAkB,EAAE,QAAQG,GAAU,CAC7DA,EAAO,iBAAiB,QAAUC,GAAU,CACxC,MAAMC,EAASF,EAAO,QAAQ,GAC9BG,EAAmBD,EAAQd,EAASS,CAAS,CACzD,CAAS,CACT,CAAK,CACL,CAEA,SAASM,EAAmBD,EAAQd,EAASS,EAAW,CAEpD,MAAMO,GADO,KAAK,MAAM,aAAa,QAAQhB,CAAO,CAAC,GAAK,IACjC,OAAOK,GAAMA,IAAOS,CAAM,EAEnD,aAAa,QAAQd,EAAS,KAAK,UAAUgB,CAAW,CAAC,EAEzD,MAAMC,EAAcR,EAAU,cAAc,6BAA6BK,CAAM,IAAI,EAAE,QAAQ,qBAAqB,EAC9GG,GACAA,EAAY,OAAM,EAIlBD,EAAY,SAAW,GACvB,SAAS,cAAc,aAAa,EAAE,UAAU,OAAO,QAAQ,CAEvE"}